<!DOCTYPE html>
<html>

    <head><title>Login - SenS</title>

        <link rel="stylesheet" type="text/css" href="/stylesheets/style.css">
        <style>
        body{
          background: url(login.png) no-repeat;
          background-repeat: no-repeat;
          background-size: cover;
    			height: 100%;
    			left: 0;
    			opacity: 0;
    			position: absolute;
    			top: 0;
    			visibility: hidden;
    			width: 150%;
        }
            img {
                width: 20%;
                height: 20%;
                margin-left: 41%;
                margin-top: 2%;
            }
            #ss{
                color: #26ae90;
            }
        </style>

        <script>
              function transfer(){
                window.open("https://sens-agriculture.herokuapp.com/signUp");
                window.close();
              }
              function forgot() {
                var f_email = document.getElementById("email").value;
                  if (f_email != "")
                  {
                    var xh = new XMLHttpRequest();
                    xh.onreadystatechange = function() {
                      if (this.readyState == 4 && this.status == 200) {
                      //  alert(this.responseText);
                        var jsonObj = JSON.parse(this.responseText);
                           var rc = jsonObj.rowCount; // OUTPUT = ROWCOUNT
                           if (rc == 1)
                           {
                             xh.open("GET", "https://sens-agriculture.herokuapp.com/nodemail?f_email="+f_email, true);
                             xh.send();
                             alert("Please check your mail for resetting the password \n Thank you.");
                           }
                           else {
                             alert("The email address you entered is not registered with us.\n Please check your credentials again!");
                           }
                    }
                      //window.open("https://sens-agriculture.herokuapp.com/forgotPassword?uname="+f_email);
                      //window.close();
                  };
                  xh.open("GET", "https://sens-agriculture.herokuapp.com/check?uname="+f_email, true);
                  xh.send();
                }
                  else {
                  alert("Please enter your email address in the Email field");
                  }
              }
            function loadDoc() {
              var f_email = document.getElementById("email").value;
                var f_password = document.getElementById("password").value;
                if( f_email == "" || f_password == "")
                {
                  alert("Please check your credentials as one or more fields have been left blank");
                  return false;
                }
                var i = 0;
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        var jsonObj = JSON.parse(xhttp.responseText);
                       for(i=0;i<jsonObj.rows.length;i++){
                            //document.writeln("<tr><td><b>Name:</b></td><td width = 50>" +       jsonObj.rows[i].product_id+"</td></tr>");
                           var pid = jsonObj.rows[i].product_id;
                           localStorage.setItem("user_id",pid);
                         window.location.href = "visual.ejs";
                       }
                    }
                    else {
                        alert("Something's wrong, please try again!");
                    }
                };
                xhttp.open("GET", "https://sens-agriculture.herokuapp.com/login?uname="+f_email+"&pwd="+f_password, true);
                xhttp.send();
            }
        </script>
    </head>

    <body>


            <img src="sens.png">


        <div id="login">
            <form name='form-login'>
                <span class="fontawesome-user"></span>
                <input type="text" id="email" placeholder="Email">

                <span class="fontawesome-lock"></span>
                <input type="password" id="password" placeholder="Password">

                  <p style="text-align: center;" onclick="forgot()"><u>Forgot Password ?</u></p>

            </form>
            <br />

             <button onClick=loadDoc()><div id="ss"><strong>LOGIN</strong></div></button>
             <button onClick=transfer()><div id="ss"><strong>SIGN UP</strong></div></button>
        </div>

       <!-- <form>
            <input type="text" placeholder="Email" id="email">
            <input type="text" placeholder="Password" id="password">
        </form>-->



    </body>

</html>
